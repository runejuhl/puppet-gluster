# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

_Public Classes_

* [`gluster`](#gluster): Installs GlusterFS and optionally creates a trusted storage pool
* [`gluster::client`](#glusterclient): Ensure that the Gluster FUSE client package is installed

_Private Classes_

* `gluster::install`: install the Gluster packages
* `gluster::params`: establishes various defaults for use in other gluster manifests
* `gluster::repo`: enables an upstream GlusterFS repository
* `gluster::repo::apt`: enable the upstream Gluster Apt repo
* `gluster::repo::yum`: enable the upstream Gluster Yum repo
* `gluster::service`: manage the glusterd service

**Defined types**

* [`gluster::mount`](#glustermount): Mounts a Gluster volume
* [`gluster::peer`](#glusterpeer): Connects to a Gluster peer.
* [`gluster::volume`](#glustervolume): Create GlusterFS volumes, and maybe extend them
* [`gluster::volume::option`](#glustervolumeoption): set or remove a Gluster volume option

## Classes

### gluster

Installs GlusterFS and optionally creates a trusted storage pool

* **Note** Copyright 2014 CoverMyMeds, unless otherwise noted

#### Examples

##### 

```puppet
class { ::gluster:
  client                 => false,
  server                 => true,
  pool                   => 'production',
  use_exported_resources => true,
  version                => '3.5',
  volumes                => { 'data1' => {
                                replica => 2,
                                bricks  => [ 'srv1.local:/export/brick1/brick',
                                             'srv2.local:/export/brick1/brick',
                                             'srv3.local:/export/brick1/brick',
                                             'srv4.local:/export/brick1/brick', ],
                                options => [ 'server.allow-insecure: on',
                                             'nfs.disable: true', ],
                              },
                            },
}
```

#### Parameters

The following parameters are available in the `gluster` class.

##### `client`

Data type: `Boolean`

whether to install the Gluster client package(s)

Default value: $gluster::params::install_client

##### `pool`

Data type: `Any`

the name of the trusted storage pool to create

Default value: $gluster::params::pool

##### `repo`

Data type: `Any`

whether to install and manage the upstream Gluster repo

Default value: $gluster::params::repo

##### `server`

Data type: `Any`

whether to the install the Gluster server packages

Default value: $gluster::params::install_server

##### `use_exported_resources`

Data type: `Any`

whether or not to export this server's gluster::server and collect other
gluster::server resources

Default value: $gluster::params::export_resources

##### `version`

Data type: `Any`

the version to install

Default value: $gluster::params::version

##### `volumes`

Data type: `Optional[Hash]`

optional list of volumes (and their properties) to create

Default value: `undef`

##### `priority`

Data type: `Optional[Integer]`

The priority for the apt/yum repository. Useful to overwrite other repositories like EPEL

Default value: `undef`

##### `repo_key_source`

Data type: `Optional`

HTTP Link or absolute path to the GPG key for the repository.

Default value: $gluster::params::repo_key_source

##### `client_package`

Data type: `Any`



Default value: $gluster::params::client_package

##### `release`

Data type: `String`



Default value: $gluster::params::release

##### `server_package`

Data type: `Any`



Default value: $gluster::params::server_package

### gluster::client

Ensure that the Gluster FUSE client package is installed

* **Note** This is a convenience class to ensure that *just* the client
is installed.  If you need both client and server, please use
the main gluster class

#### Examples

##### 

```puppet
class { gluster::client:
  repo           => true,
  client_package => 'glusterfs-fuse',
  version        => 'LATEST',
}
```

#### Parameters

The following parameters are available in the `gluster::client` class.

##### `repo`

Data type: `Boolean`

Whether to use the GlusterFS repository

Default value: $gluster::params::repo

##### `client_package`

Data type: `String`

The name of the client package to install.

Default value: $gluster::params::client_package

##### `version`

Data type: `String`

The version of the client tools to install.

Default value: $gluster::params::version

##### `repo_key_source`

Data type: `Optional`

HTTP Link or absolute path to the GPG key for the repository.

Default value: $gluster::params::repo_key_source

##### `release`

Data type: `String`



Default value: $gluster::params::release

## Defined types

### gluster::mount

Mounts a Gluster volume

* **Note** Copyright 2014 CoverMyMeds, unless otherwise noted

#### Examples

##### 

```puppet
gluster::mount { 'data1':
  ensure    => present,
  volume    => 'srv1.local:/data1',
  transport => 'tcp',
  atboot    => true,
  dump      => 0,
  pass      => 0,
}
```

#### Parameters

The following parameters are available in the `gluster::mount` defined type.

##### `volume`

Data type: `String`

the volume to mount, in "server:/volname" format

##### `log_level`

Data type: `Optional[String]`

the GlusterFS log level to use

Default value: `undef`

##### `log_file`

Data type: `Optional[String]`

the file to which to log this volume

Default value: `undef`

##### `transport`

Data type: `Optional[String]`

TCP or RDMA

Default value: `undef`

##### `direct_io_mode`

Data type: `Optional[String]`

whether or not to use direct io mode

Default value: `undef`

##### `readdirp`

Data type: `Optional[Boolean]`

whether or not to use readdirp

Default value: `undef`

##### `atboot`

Data type: `Variant[Enum['yes', 'no'], Boolean]`

whether to add this volume to /etc/fstab

Default value: 'yes'

##### `options`

Data type: `String`

a comma-separated list of GlusterFS mount options

Default value: 'defaults'

##### `dump`

Data type: `Integer`

enable or disable dump in /etc/fstab

Default value: 0

##### `pass`

Data type: `Integer`

the sequence value for fsck for this volume in /etc/fstab

Default value: 0

##### `ensure`

Data type: `Enum['defined', 'present', 'unmounted', 'absent', 'mounted']`

the state to ensure

Default value: 'mounted'

### gluster::peer

Connects to a Gluster peer. Intended to be exported by each member of
a Gluster Trusted Storage Pool.  Each server should also collect all
such exported resources for local realization.

If the title of the exported resource is NOT the FQDN of the host
on which the resource is being realized, then try to initiate a
Gluster peering relationship.

* **Note** Copyright 2014 CoverMyMeds, unless otherwise notes

* **See also**
http://www.gluster.org/pipermail/gluster-users/2013-December/038354.html
When server-a probes server-b, server-b will only record the IP address
for server-a.  When server-b next runs Puppet, it will probe server-a
because server-a's fqdn is not in the list of peers. The peering will
have been successfully established the first time, so this second
peering attempt only resolves a cosmetic issue, not a functional one.

#### Examples

##### Export this host's gluster::peer resource, and then collect all others:

```puppet
@@gluster::peer { $::fqdn:
  pool => 'production',
}
Gluster::Peer <<| pool == 'production' |>>
```

##### explicitly define peers:

```puppet
gluster::peer { 'gluster1.example.com':
  pool => 'pool1',
}
```

#### Parameters

The following parameters are available in the `gluster::peer` defined type.

##### `pool`

Data type: `Any`

the name of the storage pool to which this server should be assigned.

Default value: 'default'

##### `fqdn`

Data type: `Any`

the name of this peer to use in the pool

Default value: $::fqdn

### gluster::volume

Create GlusterFS volumes, and maybe extend them

* **Note** Copyright 2014 CoverMyMeds, unless otherwise noted

* **See also**
https://github.com/gluster/glusterfs/blob/master/doc/admin-guide/en-US/markdown/admin_managing_volumes.md#tuning-options

#### Examples

##### 

```puppet
gluster::volume { 'storage1':
  replica => 2,
  bricks  => [
               'srv1.local:/export/brick1/brick',
               'srv2.local:/export/brick1/brick',
               'srv1.local:/export/brick2/brick',
               'srv2.local:/export/brick2/brick',
  ],
  options => [
               'server.allow-insecure: on',
               'nfs.ports-insecure: on',
             ],
}
```

#### Parameters

The following parameters are available in the `gluster::volume` defined type.

##### `stripe`

Data type: `Optional[Integer]`

the stripe count to use for a striped volume

Default value: `undef`

##### `replica`

Data type: `Optional[Integer]`

the replica count to use for a replica volume

Default value: `undef`

##### `arbiter`

Data type: `Optional[Integer]`

the arbiter count to use for a replica volume

Default value: `undef`

##### `transport`

Data type: `Enum['tcp', 'rdma', 'tcp,rdma']`

the transport to use. Defaults to tcp

Default value: 'tcp'

##### `rebalance`

Data type: `Boolean`

whether to rebalance a volume when new bricks are added

Default value: `true`

##### `heal`

Data type: `Boolean`

whether to heal a replica volume when adding bricks

Default value: `true`

##### `bricks`

Data type: `Array[String, 1]`

an array of bricks to use for this volume

##### `options`

Data type: `Array[String[1]]`

an array of volume options for the volume

Default value: []

##### `remove_options`

Data type: `Boolean`

whether to permit the removal of active options that are not defined for
this volume.

Default value: `false`

##### `force`

Data type: `Boolean`



Default value: `false`

### gluster::volume::option

set or remove a Gluster volume option

* **Note** Copyright 2014 CoverMyMeds, unless otherwise noted

#### Examples

##### 

```puppet
gluster::volume::option { 'gv0:nfs.disable':
  value  => 'on',
}
```

##### 

```puppet
gluster::volume::option { 'gv0:server.allow-insecure':
  value  => 'on',
}
```

##### To remove a previously-set option:

```puppet
gluster::volume::option { 'gv0:feature.read-only':
  ensure => absent,
}
```

#### Parameters

The following parameters are available in the `gluster::volume::option` defined type.

##### `title`

the name of the volume, a colon, and the name of the option

##### `value`

Data type: `Any`

the value to set for this option

Default value: `undef`

##### `ensure`

Data type: `Enum['present', 'absent']`

whether to set or remove an option

Default value: 'present'

